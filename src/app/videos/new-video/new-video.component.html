<form #form="ngForm">
    <fieldset>
    <legend>Upload</legend>
        <div class="form-group col-xs-6">
            <label for="video">Video File</label>
            <input type="file" id="video" name="file" (change)="onFileChange($event)" required>
            <p class="help-block">Select a video file.</p>
        </div>
        <div class="form-group col-xs-6">
            <h4>Preview:</h4>
            <video controls [src]="previewFileUrl" *ngIf="previewFileUrl" width="300" height="200"></video>
        </div>

    </fieldset>

    <fieldset>
        <legend>Metadata</legend>
        <div class="form-group">
            <label for="video-language">Language</label>
            <select class="form-control video__language" id="video-language" name="language" [(ngModel)]="video.languageId" required>
                <option *ngFor="let language of languages" [value]="language?.id">{{ language?.name }}</option>
            </select>
        </div>

        <div class="form-group">
            <label for="video-category">Category</label>
            <select class="form-control video__category" id="video-category" (input)="onSelectCategory($event)" required>
                <option *ngFor="let category of categories" [value]="category?.id">{{ category?.name }}</option>
            </select>
        </div>

        <div class="form-group">
            <label for="video-subcategory">Subcategory</label>
            <select class="form-control video__subcategory" [disabled]="!selectedCategory" id="video-subcategory" name="subcategoryId" [(ngModel)]="video.subcategoryId" required>
                <option *ngFor="let subcategory of selectedCategory?.subcategories?.records" [value]="subcategory?.id">{{ subcategory?.name }}</option>
            </select>
        </div>

        <div class="form-group">
            <label for="video-speaker">Speaker</label>
            <select id="video-speaker" class="form-control" name="speakerId" [(ngModel)]="video.speakerId" required>
                <option value="">-</option>
            </select>
        </div>
    </fieldset>

    <fieldset>
        <legend>Transcription</legend>
        <div class="row">
            <div class="col-xs-6">
                <div class="form-group">
                    <label for="transcription-language">Transcription Language</label>
                    <select class="form-control video__transcription-language" id="transcription-language" (input)="onSelectTranscriptionLanguage($event)">
                        <option *ngFor="let language of transcriptionLanguages" [value]="language?.code" [selected]="language === selectedTranscriptionLanguage">{{ language?.englishName }}</option>
                    </select>
                </div>

                <div class="form-group">
                    <button id="transcribe-button" class="btn btn-default" [disabled]="!video.file" (click)="onClickTranscribe()">Transcribe</button>
                </div>
            </div>

            <div class="col-xs-6">
                <div class="form-group">
                    <label for="transcription"></label>
                    <textarea cols="30" rows="10" readonly class="form-control" id="transcription">{{ transcriptionEmitted$ | async }}</textarea>
                </div>
            </div>
        </div>

        <hr>

        <div class="row">
            <p class="help-block">* Enclose collocation occurrences in curly braces for the original video language.</p>

            <div class="col-xs-6 form-group" *ngFor="let transcript of video.transcripts; let i = index">
                <label for="transcript-{{ transcript?.languageId }}">{{ nameOfLanguageForId(transcript?.languageId) }}</label>
                <textarea name="transcript-{{ transcript?.languageId }}" [ngModel]="video.transcripts[i].text"
                          (ngModelChange)="transcriptForLanguageChanged(transcript.languageId, $event)"
                          id="transcript-{{ transcript?.languageId }}" cols="30" rows="10"
                          class="form-control transcript" required></textarea>
            </div>
        </div>
    </fieldset>

    <div class="form-group">
        <button class="btn btn-primary" type="submit">Submit</button>
    </div>
</form>